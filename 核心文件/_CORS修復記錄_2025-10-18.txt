â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  CORS å•é¡Œä¿®å¾©è¨˜éŒ„
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… æ—¥æœŸï¼š2025-10-18
ğŸ”§ å•é¡Œï¼šç„¡æ³•è¨»å†Šï¼ŒCORS éŒ¯èª¤
âœ… ç‹€æ…‹ï¼šå·²ä¿®å¾©

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å•é¡Œæè¿°
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

éŒ¯èª¤è¨Šæ¯ï¼š
Access to fetch at 'https://script.google.com/...' 
from origin 'null' has been blocked by CORS policy

åŸå› ï¼š
1. Google Apps Script ç¼ºå°‘ CORS headers
2. ç”¨æˆ¶ç›´æ¥æ‰“é–‹ HTML æ–‡ä»¶ï¼ˆorigin ç‚º nullï¼‰

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä¿®å¾©å…§å®¹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ä¿®æ”¹ doOptions() å‡½æ•¸
   âœ… æ·»åŠ å®Œæ•´çš„ CORS headers
   âœ… æ”¯æ´ OPTIONS é æª¢è«‹æ±‚
   âœ… è¨­å®š Max-Age ç‚º 86400 ç§’

2. ä¿®æ”¹ createCorsResponse() å‡½æ•¸
   âœ… æ·»åŠ  Access-Control-Allow-Origin: *
   âœ… æ·»åŠ  Access-Control-Allow-Methods
   âœ… æ·»åŠ  Access-Control-Allow-Headers

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ä¿®æ”¹çš„æ–‡ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… google-apps-script.js (æ ¹ç›®éŒ„)
âœ… æ ¸å¿ƒæ–‡ä»¶/google-apps-script.js (å‰¯æœ¬)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç¨‹å¼ç¢¼è®Šæ›´
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ä¿®æ”¹å‰ï¼š
```javascript
function doOptions(e) {
  return createCorsResponse({});
}

function createCorsResponse(data) {
  const jsonOutput = JSON.stringify(data);
  
  return ContentService.createTextOutput(jsonOutput)
    .setMimeType(ContentService.MimeType.JSON);
}
```

ä¿®æ”¹å¾Œï¼š
```javascript
function doOptions(e) {
  return ContentService
    .createTextOutput()
    .setMimeType(ContentService.MimeType.JSON)
    .setContent(JSON.stringify({ status: 'ok' }))
    .setHeader('Access-Control-Allow-Origin', '*')
    .setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')
    .setHeader('Access-Control-Allow-Headers', 'Content-Type')
    .setHeader('Access-Control-Max-Age', '86400');
}

function createCorsResponse(data) {
  const jsonOutput = JSON.stringify(data);
  
  return ContentService
    .createTextOutput(jsonOutput)
    .setMimeType(ContentService.MimeType.JSON)
    .setHeader('Access-Control-Allow-Origin', '*')
    .setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS')
    .setHeader('Access-Control-Allow-Headers', 'Content-Type');
}
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
éƒ¨ç½²æ­¥é©Ÿ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸ ç”¨æˆ¶å¿…é ˆåŸ·è¡Œï¼š

1. è¤‡è£½æ›´æ–°å¾Œçš„ google-apps-script.js
2. è²¼ä¸Šåˆ° Google Apps Script ç·¨è¼¯å™¨
3. é‡æ–°éƒ¨ç½²ï¼ˆé¸æ“‡ã€Œæ–°ç‰ˆæœ¬ã€ï¼‰
4. ä½¿ç”¨æœ¬åœ°æœå‹™å™¨é‹è¡Œï¼ˆä¸èƒ½ç›´æ¥æ‰“é–‹ HTMLï¼‰

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ¸¬è©¦æ–¹æ³•
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. é›™æ“Š start-server.bat å•Ÿå‹•æœå‹™å™¨
2. è¨ªå• http://localhost:8000/web-register.html
3. å¡«å¯«è¨»å†Šè¡¨å–®ä¸¦æäº¤
4. æ‡‰è©²çœ‹åˆ°ã€ŒğŸ‰ è¨»å†ŠæˆåŠŸã€è¨Šæ¯

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç›¸é—œæ–‡ä»¶
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“„ ğŸ”¥CORSå•é¡Œç«‹å³ä¿®å¾©_2025-10-18.md  (è©³ç´°æŒ‡å—)
ğŸ“„ âš¡ç«‹å³åŸ·è¡Œé€™3æ­¥é©Ÿ.txt              (å¿«é€Ÿæ“ä½œ)
ğŸ“„ start-server.bat                   (æœ¬åœ°æœå‹™å™¨)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ€è¡“èªªæ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

CORS Headers èªªæ˜ï¼š

â€¢ Access-Control-Allow-Origin: *
  â†’ å…è¨±æ‰€æœ‰ä¾†æºçš„è«‹æ±‚

â€¢ Access-Control-Allow-Methods: GET, POST, OPTIONS
  â†’ å…è¨±çš„ HTTP æ–¹æ³•

â€¢ Access-Control-Allow-Headers: Content-Type
  â†’ å…è¨±çš„è«‹æ±‚æ¨™é ­

â€¢ Access-Control-Max-Age: 86400
  â†’ é æª¢è«‹æ±‚çš„å¿«å–æ™‚é–“ï¼ˆ24 å°æ™‚ï¼‰

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ³¨æ„äº‹é …
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âš ï¸ é—œéµé‡é»ï¼š

1. å¿…é ˆé‡æ–°éƒ¨ç½² Google Apps Scriptï¼ˆé¸æ–°ç‰ˆæœ¬ï¼‰
2. å¿…é ˆä½¿ç”¨æœ¬åœ°æœå‹™å™¨ï¼ˆä¸èƒ½ç›´æ¥æ‰“é–‹ HTMLï¼‰
3. å¦‚æœé‚„æ˜¯å¤±æ•—ï¼Œæ¸…é™¤ç€è¦½å™¨å¿«å–

âœ… ä¿®å¾©å¾Œçš„æ•ˆæœï¼š

â€¢ æ”¯æ´è·¨åŸŸè«‹æ±‚
â€¢ æ”¯æ´ OPTIONS é æª¢
â€¢ æ‰€æœ‰ API è«‹æ±‚éƒ½èƒ½æ­£å¸¸é‹ä½œ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

