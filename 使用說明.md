# æœƒå“¡è¨»å†Šç³»çµ± - ä½¿ç”¨èªªæ˜

## ğŸ“š ç›®éŒ„

1. [å¿«é€Ÿé–‹å§‹](#å¿«é€Ÿé–‹å§‹)
2. [åŠŸèƒ½èªªæ˜](#åŠŸèƒ½èªªæ˜)
3. [API æ–‡ä»¶](#api-æ–‡ä»¶)
4. [è¨­å®šæª”èªªæ˜](#è¨­å®šæª”èªªæ˜)
5. [æ“´å……åŠŸèƒ½](#æ“´å……åŠŸèƒ½)

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æœ€å¿« 5 åˆ†é˜éƒ¨ç½²æ–¹æ¡ˆ

1. **å»ºç«‹ Google Sheets**
   - é–‹å•Ÿ [Google Sheets](https://sheets.google.com/)
   - å»ºç«‹æ–°è©¦ç®—è¡¨
   - è¤‡è£½ Sheet ID

2. **éƒ¨ç½² Apps Script**
   - é–‹å•Ÿ **æ“´å……åŠŸèƒ½ â†’ Apps Script**
   - è²¼ä¸Š `google-apps-script.js` å…§å®¹
   - ä¿®æ”¹ `SHEET_ID`
   - éƒ¨ç½²ç‚º Web App
   - è¤‡è£½éƒ¨ç½² URL

3. **è¨­å®š LINE LIFF**
   - å‰å¾€ [LINE Developers](https://developers.line.biz/)
   - å»ºç«‹ 3 å€‹ LIFF æ‡‰ç”¨
   - è¨˜ä¸‹ LIFF ID

4. **éƒ¨ç½²å‰ç«¯**
   - ä¸Šå‚³åˆ° GitHub
   - å•Ÿç”¨ GitHub Pages
   - æ›´æ–° HTML ä¸­çš„è¨­å®š

5. **æ¸¬è©¦**
   - åœ¨ LINE ä¸­é–‹å•Ÿ LIFF URL
   - å®Œæˆè¨»å†Šæ¸¬è©¦

---

## ğŸ’¡ åŠŸèƒ½èªªæ˜

### 1. æœƒå“¡è¨»å†Š (register.html)

#### åŠŸèƒ½ç‰¹è‰²
- âœ… LINE LIFF è‡ªå‹•ç™»å…¥
- âœ… è‡ªå‹•å–å¾— LINE ä½¿ç”¨è€…è³‡æ–™
- âœ… æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼é©—è­‰ï¼ˆè‡ªå‹•æ ¼å¼åŒ–ï¼‰
- âœ… Email æ ¼å¼é©—è­‰
- âœ… é‡è¤‡è¨»å†Šæª¢æŸ¥
- âœ… è¨»å†ŠæˆåŠŸè´ˆé€ 100 é»

#### ä½¿ç”¨æµç¨‹
1. ä½¿ç”¨è€…å¾ LINE é–‹å•Ÿè¨»å†Šé é¢
2. ç³»çµ±è‡ªå‹•å–å¾— LINE User ID å’Œé¡¯ç¤ºåç¨±
3. ä½¿ç”¨è€…å¡«å¯«å¿…è¦è³‡æ–™ï¼ˆå§“åã€æ‰‹æ©Ÿï¼‰
4. ç³»çµ±æª¢æŸ¥æ˜¯å¦å·²è¨»å†Šæˆ–æ‰‹æ©Ÿè™Ÿç¢¼é‡è¤‡
5. è¨»å†ŠæˆåŠŸå¾Œè‡ªå‹•è·³è½‰åˆ°æœƒå“¡ä¸­å¿ƒ

#### è¡¨å–®æ¬„ä½
| æ¬„ä½ | å¿…å¡« | èªªæ˜ |
|------|------|------|
| å§“å | âœ… | çœŸå¯¦å§“å |
| æ‰‹æ©Ÿè™Ÿç¢¼ | âœ… | æ ¼å¼ï¼š0912-345-678 |
| Email | âŒ | é¸å¡« |
| ç”Ÿæ—¥ | âŒ | é¸å¡«ï¼Œå¯ç”¨æ–¼ç”Ÿæ—¥å„ªæƒ  |

### 2. æœƒå“¡ä¸­å¿ƒ (profile.html)

#### åŠŸèƒ½ç‰¹è‰²
- ğŸ‘¤ é¡¯ç¤ºæœƒå“¡è³‡æ–™å’Œ LINE é ­åƒ
- ğŸ’° å³æ™‚é¡¯ç¤ºé»æ•¸é¤˜é¡
- ğŸ“Š å¿«é€Ÿæ“ä½œæŒ‰éˆ•
- ğŸ¨ ç¾è§€çš„ UI è¨­è¨ˆ

#### é¡¯ç¤ºè³‡è¨Š
- LINE é ­åƒ
- æœƒå“¡å§“å
- æ‰‹æ©Ÿè™Ÿç¢¼
- Email
- ç•¶å‰é»æ•¸

#### æ“ä½œæŒ‰éˆ•
- **è½‰é»çµ¦å¥½å‹** - è·³è½‰åˆ°è½‰é»é é¢
- **é»æ•¸è¨˜éŒ„** - æŸ¥çœ‹äº¤æ˜“æ­·å²ï¼ˆéœ€è‡ªè¡Œå¯¦ä½œï¼‰
- **ç·¨è¼¯è³‡æ–™** - ä¿®æ”¹æœƒå“¡è³‡æ–™ï¼ˆéœ€è‡ªè¡Œå¯¦ä½œï¼‰

### 3. é»æ•¸è½‰ç§» (transfer.html)

#### åŠŸèƒ½ç‰¹è‰²
- ğŸ’¸ å³æ™‚è½‰é»åŠŸèƒ½
- âœ… è‡ªå‹•é©—è­‰æ”¶æ¬¾äºº
- ğŸ¯ å¿«é€Ÿé¸æ“‡é‡‘é¡
- ğŸ“ è½‰é»ç•™è¨€
- âœ”ï¸ è½‰é»ç¢ºèªè¦–çª—

#### ä½¿ç”¨æµç¨‹
1. è¼¸å…¥æ”¶æ¬¾äººæ‰‹æ©Ÿè™Ÿç¢¼
2. ç³»çµ±è‡ªå‹•é©—è­‰ä¸¦é¡¯ç¤ºæ”¶æ¬¾äººå§“å
3. è¼¸å…¥è½‰é»æ•¸é‡ï¼ˆæˆ–ä½¿ç”¨å¿«é€Ÿé¸æ“‡ï¼‰
4. é¸å¡«ç•™è¨€
5. ç¢ºèªè½‰é»è³‡è¨Š
6. å®Œæˆè½‰é»

#### é©—è­‰è¦å‰‡
- âŒ ä¸èƒ½è½‰é»çµ¦è‡ªå·±
- âŒ é»æ•¸ä¸è¶³
- âŒ æ”¶æ¬¾äººä¸å­˜åœ¨
- âŒ è½‰é»æ•¸é‡å°æ–¼ 1

---

## ğŸ“¡ API æ–‡ä»¶

### åŸºç¤è³‡è¨Š

**Base URL:**
```
https://script.google.com/macros/s/[YOUR_DEPLOYMENT_ID]/exec
```

**èªè­‰æ–¹å¼:** ç„¡éœ€èªè­‰ï¼ˆå…¬é–‹ APIï¼‰

**å›æ‡‰æ ¼å¼:** JSON

---

### 1. æª¢æŸ¥æœƒå“¡æ˜¯å¦å­˜åœ¨

**ç«¯é»:** `GET /exec?action=check`

**åƒæ•¸:**
| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| lineUserId | string | âœ… | LINE User ID |

**è«‹æ±‚ç¯„ä¾‹:**
```bash
GET /exec?action=check&lineUserId=U1234567890
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "registered": true,
  "member": {
    "name": "ç‹å°æ˜",
    "phone": "0912-345-678",
    "points": 150
  }
}
```

**æœªè¨»å†Šå›æ‡‰:**
```json
{
  "registered": false
}
```

---

### 2. å–å¾—æœƒå“¡è³‡æ–™

**ç«¯é»:** `GET /exec?action=profile`

**åƒæ•¸:**
| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| lineUserId | string | âœ… | LINE User ID |

**è«‹æ±‚ç¯„ä¾‹:**
```bash
GET /exec?action=profile&lineUserId=U1234567890
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "lineUserId": "U1234567890",
  "name": "ç‹å°æ˜",
  "phone": "0912-345-678",
  "email": "wang@example.com",
  "birthday": "1990-01-01",
  "lineName": "Wang Ming",
  "linePicture": "https://...",
  "points": 150,
  "createdAt": "2025-10-11T10:00:00.000Z",
  "updatedAt": "2025-10-11T10:30:00.000Z"
}
```

---

### 3. é€éæ‰‹æ©Ÿè™Ÿç¢¼æª¢æŸ¥æœƒå“¡

**ç«¯é»:** `GET /exec?action=check-user`

**åƒæ•¸:**
| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| phone | string | âœ… | æ‰‹æ©Ÿè™Ÿç¢¼ |

**è«‹æ±‚ç¯„ä¾‹:**
```bash
GET /exec?action=check-user&phone=0912-345-678
```

**æ‰¾åˆ°æœƒå“¡:**
```json
{
  "exists": true,
  "name": "ç‹å°æ˜",
  "lineUserId": "U1234567890",
  "phone": "0912-345-678"
}
```

**æ‰¾ä¸åˆ°æœƒå“¡:**
```json
{
  "exists": false
}
```

---

### 4. è¨»å†Šæ–°æœƒå“¡

**ç«¯é»:** `POST /exec?action=register`

**è«‹æ±‚ Body:**
```json
{
  "lineUserId": "U1234567890",
  "name": "ç‹å°æ˜",
  "phone": "0912-345-678",
  "email": "wang@example.com",
  "birthday": "1990-01-01",
  "lineName": "Wang Ming",
  "linePicture": "https://..."
}
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "message": "è¨»å†ŠæˆåŠŸ",
  "points": 100
}
```

**å¤±æ•—å›æ‡‰:**
```json
{
  "success": false,
  "message": "æ­¤å¸³è™Ÿå·²ç¶“è¨»å†Šéäº†"
}
```

---

### 5. é»æ•¸è½‰ç§»

**ç«¯é»:** `POST /exec?action=transfer`

**è«‹æ±‚ Body:**
```json
{
  "senderUserId": "U1234567890",
  "receiverPhone": "0923-456-789",
  "receiverUserId": "U0987654321",
  "points": 50,
  "message": "è¬è¬ä½ ï¼"
}
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "message": "è½‰é»æˆåŠŸ",
  "remainingPoints": 100,
  "receiverNewPoints": 150
}
```

**å¤±æ•—å›æ‡‰:**
```json
{
  "success": false,
  "message": "é»æ•¸ä¸è¶³"
}
```

---

### 6. å–å¾—äº¤æ˜“è¨˜éŒ„

**ç«¯é»:** `GET /exec?action=transactions`

**åƒæ•¸:**
| åƒæ•¸ | é¡å‹ | å¿…å¡« | èªªæ˜ |
|------|------|------|------|
| lineUserId | string | âœ… | LINE User ID |
| limit | number | âŒ | é™åˆ¶ç­†æ•¸ï¼ˆé è¨­ 20ï¼‰ |

**è«‹æ±‚ç¯„ä¾‹:**
```bash
GET /exec?action=transactions&lineUserId=U1234567890&limit=10
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "transactions": [
    {
      "id": "uuid-1234",
      "type": "transfer_out",
      "senderUserId": "U1234567890",
      "receiverUserId": "U0987654321",
      "senderName": "ç‹å°æ˜",
      "receiverName": "æå°è¯",
      "points": -50,
      "message": "è¬è¬",
      "createdAt": "2025-10-11T10:30:00.000Z"
    }
  ],
  "total": 1
}
```

---

### 7. æ›´æ–°æœƒå“¡è³‡æ–™

**ç«¯é»:** `POST /exec?action=update-profile`

**è«‹æ±‚ Body:**
```json
{
  "lineUserId": "U1234567890",
  "name": "ç‹å¤§æ˜",
  "email": "new@example.com"
}
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "message": "æ›´æ–°æˆåŠŸ"
}
```

---

### 8. ç®¡ç†å“¡èª¿æ•´é»æ•¸

**ç«¯é»:** `POST /exec?action=adjust-points`

**è«‹æ±‚ Body:**
```json
{
  "lineUserId": "U1234567890",
  "points": 100,
  "reason": "è£œå„Ÿ"
}
```

**æˆåŠŸå›æ‡‰:**
```json
{
  "success": true,
  "message": "èª¿æ•´æˆåŠŸ",
  "newPoints": 250
}
```

---

## âš™ï¸ è¨­å®šæª”èªªæ˜

ä½¿ç”¨ `config.template.js` ä½œç‚ºè¨­å®šæª”ç¯„æœ¬ï¼š

### 1. LIFF è¨­å®š

```javascript
LIFF: {
  REGISTER: '1234567890-AbCdEfGh',  // è¨»å†Šé é¢ LIFF ID
  PROFILE: '1234567890-IjKlMnOp',   // æœƒå“¡ä¸­å¿ƒ LIFF ID
  TRANSFER: '1234567890-QrStUvWx',  // è½‰é»é é¢ LIFF ID
}
```

### 2. API ç«¯é»è¨­å®š

```javascript
API: {
  BASE_URL: 'https://script.google.com/macros/s/YOUR_ID/exec',
  ENDPOINTS: {
    CHECK: '?action=check',
    PROFILE: '?action=profile',
    // ...
  }
}
```

### 3. å‰ç«¯ç¶²å€è¨­å®š

```javascript
FRONTEND: {
  DOMAIN: 'https://username.github.io/repo-name',
  PAGES: {
    INDEX: '/index.html',
    REGISTER: '/register.html',
    // ...
  }
}
```

### 4. ç³»çµ±è¨­å®š

```javascript
SYSTEM: {
  INITIAL_POINTS: 100,      // è¨»å†Šè´ˆé€é»æ•¸
  MIN_TRANSFER_POINTS: 1,   // æœ€å°è½‰é»æ•¸é‡
  MAX_TRANSFER_POINTS: 0,   // æœ€å¤§è½‰é»æ•¸é‡ï¼ˆ0=ä¸é™åˆ¶ï¼‰
  DEBUG_MODE: false,        // é™¤éŒ¯æ¨¡å¼
}
```

---

## ğŸ”§ æ“´å……åŠŸèƒ½

### 1. æ–°å¢é»æ•¸è¨˜éŒ„é é¢

å»ºç«‹ `history.html`ï¼š

```javascript
// å–å¾—äº¤æ˜“è¨˜éŒ„
const res = await fetch(
  CONFIG.getApiUrl(CONFIG.API.ENDPOINTS.TRANSACTIONS, {
    lineUserId: lineUserId,
    limit: 50
  })
);
const data = await res.json();

// é¡¯ç¤ºè¨˜éŒ„
data.transactions.forEach(trans => {
  // é¡¯ç¤ºäº¤æ˜“é …ç›®
});
```

### 2. æ–°å¢ç·¨è¼¯è³‡æ–™é é¢

å»ºç«‹ `edit.html`ï¼š

```javascript
// æ›´æ–°æœƒå“¡è³‡æ–™
const res = await fetch(
  CONFIG.API.BASE_URL + CONFIG.API.ENDPOINTS.UPDATE_PROFILE,
  {
    method: 'POST',
    body: JSON.stringify({
      lineUserId: lineUserId,
      name: newName,
      email: newEmail
    })
  }
);
```

### 3. æ–°å¢é»æ•¸æ’è¡Œæ¦œ

åœ¨ Apps Script ä¸­å·²åŒ…å« `getLeaderboard()` å‡½æ•¸ï¼š

```javascript
// å‘¼å«æ’è¡Œæ¦œ API
const res = await fetch(
  CONFIG.getApiUrl('?action=leaderboard', { limit: 10 })
);
```

### 4. æ–°å¢çµ±è¨ˆå ±è¡¨

åœ¨ Apps Script ä¸­å·²åŒ…å« `getStatistics()` å‡½æ•¸ï¼š

```javascript
// å–å¾—çµ±è¨ˆè³‡æ–™
const res = await fetch(
  CONFIG.getApiUrl('?action=statistics')
);
```

### 5. LINE æ¨æ’­é€šçŸ¥

æ•´åˆ LINE Messaging APIï¼š

```javascript
// åœ¨ Apps Script ä¸­æ–°å¢
function sendLineNotify(userId, message) {
  const url = 'https://api.line.me/v2/bot/message/push';
  const payload = {
    to: userId,
    messages: [{
      type: 'text',
      text: message
    }]
  };
  
  UrlFetchApp.fetch(url, {
    method: 'post',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer YOUR_CHANNEL_ACCESS_TOKEN'
    },
    payload: JSON.stringify(payload)
  });
}
```

---

## ğŸ“Š è³‡æ–™çµæ§‹

### Members è¡¨

```
lineUserId    | name   | phone         | email              | birthday   | points | createdAt
------------- | ------ | ------------- | ------------------ | ---------- | ------ | ----------
U1234567890   | ç‹å°æ˜  | 0912-345-678  | wang@example.com   | 1990-01-01 | 150    | 2025-10-11
U0987654321   | æå°è¯  | 0923-456-789  | lee@example.com    | 1992-05-15 | 200    | 2025-10-11
```

### Transactions è¡¨

```
id       | type          | senderUserId | receiverUserId | points | message | createdAt
-------- | ------------- | ------------ | -------------- | ------ | ------- | ----------
uuid-001 | register      |              | U1234567890    | 100    | è¨»å†Šè´ˆé€ | 2025-10-11
uuid-002 | transfer_out  | U1234567890  | U0987654321    | -50    | è¬è¬    | 2025-10-11
uuid-003 | transfer_in   | U1234567890  | U0987654321    | 50     | è¬è¬    | 2025-10-11
```

---

## ğŸ¯ æœ€ä½³å¯¦è¸

### 1. éŒ¯èª¤è™•ç†

```javascript
try {
  const res = await fetch(url);
  const data = await res.json();
  
  if (data.success) {
    // è™•ç†æˆåŠŸ
  } else {
    // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
    showMessage(data.message, 'error');
  }
} catch (error) {
  // è™•ç†ç¶²è·¯éŒ¯èª¤
  showMessage('ç³»çµ±éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦', 'error');
  CONFIG.error('API Error:', error);
}
```

### 2. è¼‰å…¥ç‹€æ…‹

```javascript
// é¡¯ç¤ºè¼‰å…¥ä¸­
submitBtn.disabled = true;
submitBtn.innerHTML = '<span class="spinner-small"></span> è™•ç†ä¸­...';

// å®Œæˆå¾Œæ¢å¾©
submitBtn.disabled = false;
submitBtn.innerHTML = 'é€å‡º';
```

### 3. è³‡æ–™é©—è­‰

```javascript
// å‰ç«¯é©—è­‰
if (!phone || phone.length < 12) {
  showMessage('è«‹è¼¸å…¥æ­£ç¢ºçš„æ‰‹æ©Ÿè™Ÿç¢¼', 'error');
  return;
}

// å¾Œç«¯ä¹Ÿè¦é©—è­‰
```

---

**å®Œæ•´æ–‡ä»¶è«‹åƒè€ƒ [éƒ¨ç½²æŒ‡å—.md](./éƒ¨ç½²æŒ‡å—.md)** ğŸ“–

